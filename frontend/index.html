<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Botija Crypto AI Trading Bot</title>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>‚ö°</text></svg>"
      type="image/svg+xml"
    />
    <script
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
      defer
    ></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/static/css/components.css" />
  </head>

  <body
    class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 min-h-screen text-gray-100"
  >
    <div x-data="app()" x-init="init()" class="min-h-screen flex flex-col">
      <!-- Header/Navigation -->
      <nav class="bg-gray-950 border-b border-gray-700">
        <div
          class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center"
        >
          <div class="flex items-center gap-2">
            <span class="text-2xl font-bold text-green-500">‚ö°</span>
            <h1 class="text-xl font-bold">Botija Crypto AI Trading Bot</h1>
          </div>
          <div class="flex items-center gap-6">
            <button
              @click="showHowItWorks = true"
              class="text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1"
            >
              <i class="fa-solid fa-circle-info"></i>
              <span>How It Works</span>
            </button>
            <div x-show="!loading && status" class="flex items-center gap-2">
              <span
                class="inline-block w-3 h-3 bg-green-500 rounded-full animate-pulse"
              ></span>
              <span class="text-sm text-green-400">Connected</span>
            </div>
            <div x-show="loading" class="text-blue-400 text-sm">Loading...</div>
            <div class="text-xs text-gray-500">
              Next trading cycle in:
              <span x-text="formatTime(schedulerStatus.seconds_until_next)"></span>
            </div>
          </div>
        </div>
      </nav>

      <!-- How It Works Modal -->
      <template x-if="showHowItWorks">
        <div
          class="fixed inset-0 z-50 flex items-center justify-center p-4"
          @keydown.escape.window="showHowItWorks = false"
        >
          <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" @click="showHowItWorks = false"></div>
          <div class="relative bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[85vh] overflow-hidden" @click.stop>
            <!-- Header -->
            <div class="flex items-center justify-between px-6 py-4 border-b border-gray-700 bg-gray-800/50">
              <h2 class="text-xl font-bold flex items-center gap-2">
                <i class="fa-solid fa-circle-info text-blue-400"></i> How It Works
              </h2>
              <button @click="showHowItWorks = false" class="text-gray-400 hover:text-white transition-colors p-1">
                <i class="fa-solid fa-xmark text-xl"></i>
              </button>
            </div>
            <!-- Tabs -->
            <div class="flex border-b border-gray-700 bg-gray-800/30 px-4">
              <template x-for="tab in ['strategy', 'ai', 'backtest', 'dashboard', 'tech']" :key="tab">
                <button
                  @click="howItWorksTab = tab"
                  :class="howItWorksTab === tab ? 'text-green-400 border-b-2 border-green-400' : 'text-gray-400 hover:text-white'"
                  class="px-4 py-3 text-sm font-medium transition-colors capitalize"
                >
                  <i :class="{
                    'fa-solid fa-robot': tab === 'strategy',
                    'fa-solid fa-brain': tab === 'ai',
                    'fa-solid fa-chart-line': tab === 'backtest',
                    'fa-solid fa-desktop': tab === 'dashboard',
                    'fa-solid fa-code': tab === 'tech'
                  }" class="mr-1"></i>
                  <span x-text="tab === 'ai' ? 'AI Analysis' : tab === 'tech' ? 'Tech Stack' : tab.charAt(0).toUpperCase() + tab.slice(1)"></span>
                </button>
              </template>
            </div>
            <!-- Content -->
            <div class="p-6 overflow-y-auto max-h-[60vh] text-gray-300 space-y-4" x-html="getTabHTML(howItWorksTab)"></div>
            <!-- Footer -->
            <div class="px-6 py-4 border-t border-gray-700 bg-gray-800/30 text-center">
              <span class="text-xs text-gray-500">Botija Crypto v3.4.0 ‚Ä¢ Built with ‚ö° by Orlando Batista</span>
            </div>
          </div>
        </div>
      </template>

      <!-- Main Content -->
      <main class="flex-1 max-w-7xl mx-auto w-full px-4 py-8">
        <!-- Top KPIs - Bot Status & Portfolio -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
          <!-- Bot Status -->
          <div
            class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border border-gray-700 p-6 shadow-lg"
          >
            <div class="flex items-center justify-between mb-3">
              <div class="text-sm font-medium text-gray-400">Bot Status</div>
              <span
                class="inline-block w-3 h-3 bg-green-500 rounded-full animate-pulse"
              ></span>
            </div>
            <div
              class="text-3xl font-bold text-green-400 mb-1"
              x-text="botStatus.is_running ? 'ACTIVE' : 'INACTIVE'"
            ></div>
            <div class="text-xs">
              <span
                :class="schedulerStatus.trading_mode === 'REAL' ? 'text-red-400 font-semibold' : 'text-gray-500'"
                x-text="schedulerStatus.trading_mode || 'PAPER'"
              ></span>
              <span x-show="schedulerStatus.trading_mode === 'REAL'" class="text-red-400 ml-1">üî¥</span>
              <span x-show="schedulerStatus.uptime_seconds > 0" class="text-gray-500"> | </span>
              <span x-show="schedulerStatus.uptime_seconds > 0" class="text-gray-500" x-text="formatUptime(schedulerStatus.uptime_seconds)"></span>
            </div>
          </div>

          <!-- BTC Balance -->
          <div
            class="bg-gradient-to-br from-amber-900/30 to-gray-900 rounded-xl border border-amber-700/50 p-6 shadow-lg"
          >
            <div class="flex items-center justify-between mb-3">
              <div class="text-sm font-medium text-gray-400">BTC Balance</div>
              <span class="text-xl text-gray-500">‚Çø</span>
            </div>
            <div
              class="text-2xl font-bold text-amber-400 mb-1"
              x-text="formatBTC(botStatus.btc_balance)"
            ></div>
            <div class="text-xs text-gray-500">Bitcoin holdings</div>
          </div>

          <!-- USD Balance -->
          <div
            class="bg-gradient-to-br from-emerald-900/30 to-gray-900 rounded-xl border border-emerald-700/50 p-6 shadow-lg"
          >
            <div class="flex items-center justify-between mb-3">
              <div class="text-sm font-medium text-gray-400">USD Balance</div>
              <span class="text-xl text-gray-500">$</span>
            </div>
            <div
              class="text-2xl font-bold text-emerald-400 mb-1"
              x-text="formatUSD(botStatus.usd_balance)"
            ></div>
            <div class="text-xs text-gray-500">Available to trade</div>
          </div>

          <!-- Total Portfolio -->
          <div
            class="bg-gradient-to-br from-purple-900/30 to-gray-900 rounded-xl border border-purple-700/50 p-6 shadow-lg"
          >
            <div class="flex items-center justify-between mb-3">
              <div class="text-sm font-medium text-purple-300">Total Value</div>
              <span class="text-xl text-gray-500">‚óÜ</span>
            </div>
            <div
              class="text-2xl font-bold text-purple-400 mb-1"
              x-text="formatUSD(totalPortfolio)"
            ></div>
            <div class="text-xs text-purple-300/70">Portfolio value</div>
          </div>
        </div>

        <!-- Trading Cycles -->
        <div
          class="bg-gray-800 rounded-xl border border-gray-700 p-6 mb-6 shadow-lg"
        >
          <div class="flex flex-wrap justify-between items-center gap-4 mb-6">
            <div>
              <h2 class="text-xl font-bold flex items-center gap-2">
                <i class="fa-solid fa-chart-line text-gray-500"></i> Trading Cycles
              </h2>
              <div class="flex items-center gap-1 mt-1">
                <span class="text-gray-400 text-sm">Next cycle in</span>
                <span class="text-gray-300 text-base font-semibold" x-text="formatTime(schedulerStatus.seconds_until_next)"></span>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <button
                @click="runManualCycle()"
                :disabled="manualCycleRunning"
                :class="manualCycleRunning ? 'bg-gray-600 cursor-not-allowed' : 'bg-gray-700 hover:bg-gray-600 border border-gray-600'"
                class="px-4 py-2 rounded-lg text-sm font-semibold transition-colors flex items-center gap-2 text-gray-300"
              >
                <span x-show="!manualCycleRunning"><i class="fa-solid fa-play mr-1"></i>Run</span>
                <span x-show="manualCycleRunning" class="flex items-center gap-1">
                  <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  ...
                </span>
              </button>
              <button
                @click="fetchCycles()"
                class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg text-sm font-semibold transition-colors border border-gray-600"
              >
                <i class="fa-solid fa-rotate mr-1"></i>Refresh
              </button>
            </div>
          </div>
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead class="bg-gray-700/50 border-b border-gray-600">
                <tr>
                  <th class="px-3 py-3 text-left text-xs">Time</th>
                  <th class="px-3 py-3 text-left text-xs">Price</th>
                  <th class="px-3 py-3 text-left text-xs">Strategy</th>
                  <th class="px-3 py-3 text-left text-xs">Indicators</th>
                  <th class="px-3 py-3 text-left text-xs">AI Signal</th>
                  <th class="px-3 py-3 text-left text-xs">Action</th>
                  <th class="px-3 py-3 text-left text-xs">Balances</th>
                  <th class="px-3 py-3 text-left text-xs">Mode</th>
                  <th class="px-3 py-3 text-right text-xs">Exec</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-700">
                <template x-for="cycle in paginatedCycles" :key="cycle.id">
                  <tr class="hover:bg-gray-700/30 transition-colors">
                    <td class="px-3 py-3 text-gray-300">
                      <div class="text-xs font-mono">
                        <div x-text="toETDate(cycle.timestamp)"></div>
                        <div class="text-gray-500" x-text="toETTimeShort(cycle.timestamp)"></div>
                      </div>
                    </td>
                    <td class="px-3 py-3">
                      <div
                        class="font-semibold text-gray-100 text-sm"
                        x-text="formatUSD(cycle.btc_price)"
                      ></div>
                    </td>
                    <td class="px-3 py-3">
                      <div class="text-xs space-y-1">
                        <!-- AI Regime -->
                        <div class="flex items-center gap-1">
                          <span
                            class="px-2 py-0.5 rounded text-xs font-bold border"
                            :class="{
                              'bg-emerald-900/30 text-emerald-400 border-emerald-800/50': cycle.ai_regime === 'BULL',
                              'bg-red-900/30 text-red-400 border-red-800/50': cycle.ai_regime === 'BEAR',
                              'bg-gray-700 text-gray-300 border-gray-600': cycle.ai_regime === 'LATERAL',
                              'bg-amber-900/30 text-amber-400 border-amber-800/50': cycle.ai_regime === 'VOLATILE',
                              'bg-gray-700 text-gray-400 border-gray-600': !cycle.ai_regime
                            }"
                            x-text="cycle.ai_regime || 'N/A'"
                          ></span>
                        </div>
                        <!-- Leverage -->
                        <div>
                          <span class="text-gray-500">Leverage:</span>
                          <span
                            :class="cycle.leverage_multiplier > 1 ? 'text-purple-400 font-bold' : 'text-gray-400'"
                            x-text="cycle.leverage_multiplier ? 'x' + cycle.leverage_multiplier : 'x1.0'"
                          ></span>
                        </div>
                        <!-- Winter Mode -->
                        <div>
                          <span class="text-gray-500">Winter:</span>
                          <span x-text="cycle.is_winter_mode ? '‚ùÑÔ∏è Active' : '‚òÄÔ∏è Off'"></span>
                        </div>
                      </div>
                    </td>
                    <td class="px-3 py-3">
                      <div class="text-xs space-y-1">
                        <div>
                          <span class="text-gray-500">EMA20:</span>
                          <span x-text="formatNumber(cycle.ema20, 0)"></span>
                        </div>
                        <div>
                          <span class="text-gray-500">EMA50:</span>
                          <span x-text="formatNumber(cycle.ema50, 0)"></span>
                        </div>
                        <div>
                          <span class="text-gray-500">EMA200:</span>
                          <span x-text="cycle.ema200 ? formatNumber(cycle.ema200, 0) : 'N/A'"></span>
                        </div>
                        <div>
                          <span class="text-gray-500">RSI:</span>
                          <span
                            :class="cycle.rsi14 > 70 ? 'text-red-400' : cycle.rsi14 < 30 ? 'text-green-400' : 'text-gray-300'"
                            x-text="formatNumber(cycle.rsi14, 1)"
                          ></span>
                        </div>
                      </div>
                    </td>
                    <td class="px-3 py-3">
                      <div class="flex items-center gap-2">
                        <span
                          class="px-2 py-1 rounded text-xs font-semibold border"
                          :class="{
                                                    'bg-emerald-900/30 text-emerald-400 border-emerald-800/50': cycle.ai_signal === 'BUY',
                                                    'bg-red-900/30 text-red-400 border-red-800/50': cycle.ai_signal === 'SELL',
                                                    'bg-gray-700 text-gray-300 border-gray-600': cycle.ai_signal === 'HOLD'
                                                }"
                          x-text="cycle.ai_signal"
                        >
                        </span>
                        <span
                          class="text-xs text-gray-400"
                          x-text="(cycle.ai_confidence * 100).toFixed(0) + '%'"
                        ></span>
                      </div>
                      <div
                        class="text-xs text-gray-500 mt-1 max-w-xs truncate cursor-help"
                        x-text="cycle.ai_reason"
                        x-show="cycle.ai_reason"
                        :title="cycle.ai_reason"
                      ></div>
                    </td>
                    <td class="px-3 py-3">
                      <span
                        class="px-2 py-1 rounded text-xs font-bold border"
                        :class="{
                                                'bg-emerald-900/30 text-emerald-400 border-emerald-800/50': cycle.action === 'BOUGHT',
                                                'bg-red-900/30 text-red-400 border-red-800/50': cycle.action === 'SOLD',
                                                'bg-gray-700 text-gray-300 border-gray-600': cycle.action === 'HOLD',
                                                'bg-red-900/50 text-red-400 border-red-700': cycle.action === 'ERROR' || cycle.action.includes('FAILED')
                                            }"
                        x-text="cycle.action"
                      >
                      </span>
                      <div
                        class="text-xs text-gray-500 mt-1"
                        x-text="cycle.trade_id"
                        x-show="cycle.trade_id"
                      ></div>
                    </td>
                    <td class="px-3 py-3">
                      <div class="text-xs space-y-1">
                        <div>
                          <span
                            class="text-amber-400"
                            x-text="formatBTC(cycle.btc_balance)"
                          ></span>
                          BTC
                        </div>
                        <div>
                          <span
                            class="text-emerald-400"
                            x-text="formatUSD(cycle.usd_balance)"
                          ></span>
                          USD
                        </div>
                      </div>
                    </td>
                    <td class="px-3 py-3">
                      <div class="flex flex-col gap-1">
                        <span
                          :class="cycle.trading_mode === 'REAL' ? 'px-2 py-1 rounded text-xs font-semibold bg-red-900/50 text-red-400 border border-red-700' : 'px-2 py-1 rounded text-xs font-semibold bg-gray-700 text-gray-300 border border-gray-600'"
                          x-text="cycle.trading_mode"
                        >
                        </span>
                        <span
                          x-show="cycle.trigger"
                          class="px-2 py-1 rounded text-xs font-semibold bg-gray-700 text-gray-300 border border-gray-600"
                          x-text="cycle.trigger"
                        >
                        </span>
                      </div>
                    </td>
                    <td class="px-3 py-3 text-right">
                      <span
                        class="text-xs text-gray-400"
                        x-text="cycle.execution_time_ms + 'ms'"
                      ></span>
                    </td>
                  </tr>
                </template>
              </tbody>
            </table>
            <div
              x-show="cycles.length === 0"
              class="text-gray-500 text-center py-8"
            >
              No trading cycles recorded yet
            </div>

            <!-- Pagination Controls -->
            <div
              x-show="cycles.length > 0"
              class="mt-6 flex items-center justify-between border-t border-gray-700 pt-4"
            >
              <div class="text-sm text-gray-400">
                Showing <span x-text="((cyclesCurrentPage - 1) * cyclesItemsPerPage) + 1"></span>
                to <span x-text="Math.min(cyclesCurrentPage * cyclesItemsPerPage, cycles.length)"></span>
                of <span x-text="cycles.length"></span> cycles
              </div>
              <div class="flex items-center gap-2">
                <button
                  @click="cyclesPrevPage()"
                  :disabled="cyclesCurrentPage === 1"
                  :class="cyclesCurrentPage === 1 ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-600'"
                  class="px-4 py-2 bg-gray-700 rounded-lg text-sm font-semibold transition-colors"
                >
                  ‚Üê Previous
                </button>
                <div class="text-sm text-gray-400">
                  Page <span x-text="cyclesCurrentPage"></span> of <span x-text="cyclesTotalPages"></span>
                </div>
                <button
                  @click="cyclesNextPage()"
                  :disabled="cyclesCurrentPage === cyclesTotalPages"
                  :class="cyclesCurrentPage === cyclesTotalPages ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-600'"
                  class="px-4 py-2 bg-gray-700 rounded-lg text-sm font-semibold transition-colors"
                >
                  Next ‚Üí
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Recent Trades -->
        <div
          class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border border-gray-700 p-6 mb-6 shadow-lg"
        >
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-bold flex items-center gap-2">
              <i class="fa-solid fa-coins text-gray-500"></i> Recent Trades
            </h2>
            <button
              @click="refreshStatus()"
              class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg text-sm font-semibold transition-colors border border-gray-600"
            >
              <i class="fa-solid fa-rotate mr-1"></i>Refresh
            </button>
          </div>
          <div x-show="trades.length > 0" class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead class="bg-gray-700/50 border-b border-gray-600">
                <tr>
                  <th class="px-4 py-3 text-left">Trade ID</th>
                  <th class="px-4 py-3 text-left">Type</th>
                  <th class="px-4 py-3 text-left">Entry Price</th>
                  <th class="px-4 py-3 text-left">Exit Price</th>
                  <th class="px-4 py-3 text-left">Quantity</th>
                  <th class="px-4 py-3 text-left">P/L</th>
                  <th class="px-4 py-3 text-left">Status</th>
                  <th class="px-4 py-3 text-left">Date</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-700">
                <template
                  x-for="(trade, index) in trades"
                  :key="'trade-' + index"
                >
                  <tr class="hover:bg-gray-700/30 transition-colors">
                    <td
                      class="px-4 py-3 font-mono text-xs text-gray-400"
                      x-text="trade.trade_id"
                    ></td>
                    <td class="px-4 py-3">
                      <span
                        :class="trade.order_type === 'BUY' ? 'bg-green-600' : 'bg-red-600'"
                        class="px-2 py-1 rounded text-xs font-bold"
                        x-text="trade.order_type"
                      >
                      </span>
                    </td>
                    <td
                      class="px-4 py-3 text-green-400 font-semibold"
                      x-text="trade.entry_price ? formatUSD(trade.entry_price) : 'N/A'"
                    ></td>
                    <td
                      class="px-4 py-3 text-blue-400 font-semibold"
                      x-text="trade.exit_price ? formatUSD(trade.exit_price) : '-'"
                    ></td>
                    <td
                      class="px-4 py-3 font-mono text-xs"
                      x-text="trade.quantity ? formatBTC(trade.quantity) + ' BTC' : 'N/A'"
                    ></td>
                    <td class="px-4 py-3">
                      <span
                        :class="trade.profit_loss > 0 ? 'text-green-400' : trade.profit_loss < 0 ? 'text-red-400' : 'text-gray-400'"
                        class="font-bold"
                        x-text="trade.profit_loss ? formatUSD(trade.profit_loss) : '-'"
                      >
                      </span>
                    </td>
                    <td class="px-4 py-3">
                      <span
                        :class="{
                          'bg-green-600': trade.status === 'CLOSED',
                          'bg-blue-600': trade.status === 'OPEN',
                          'bg-gray-600': trade.status === 'CANCELLED'
                        }"
                        class="px-2 py-1 rounded text-xs font-semibold"
                        x-text="trade.status"
                      >
                      </span>
                    </td>
                    <td
                      class="px-4 py-3 text-xs text-gray-400"
                      x-text="toET(trade.created_at)"
                    ></td>
                  </tr>
                </template>
              </tbody>
            </table>
          </div>
          <div
            x-show="trades.length === 0"
            class="text-gray-500 text-center py-12"
          >
            <i class="fa-solid fa-chart-column text-4xl text-gray-600 mb-3"></i>
            <div class="text-lg">No trades executed yet</div>
            <div class="text-sm mt-2">Waiting for buy signals...</div>
          </div>
        </div>

        <!-- Application Logs -->
        <div
          class="bg-gray-800 rounded-xl border border-gray-700 p-6 shadow-lg"
        >
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-bold flex items-center gap-2">
              <i class="fa-solid fa-terminal text-gray-500"></i> Application Logs
            </h2>
            <div class="flex gap-2">
              <select
                x-model="logLevel"
                @change="fetchLogs()"
                class="bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm"
              >
                <option value="">All Levels</option>
                <option value="INFO">INFO</option>
                <option value="WARNING">WARNING</option>
                <option value="ERROR">ERROR</option>
              </select>
              <button
                @click="fetchLogs()"
                class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg text-sm font-semibold transition-colors border border-gray-600"
              >
                <i class="fa-solid fa-rotate mr-1"></i>Refresh
              </button>
              <a
                href="/api/v1/bot/logs/download"
                download="botija.log"
                class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg text-sm font-semibold transition-colors border border-gray-600 inline-block"
              >
                <i class="fa-solid fa-download mr-1"></i>Download
              </a>
            </div>
          </div>
          <div
            class="bg-gray-900 rounded-lg p-4 font-mono text-xs max-h-96 overflow-y-auto border border-gray-700"
            id="logs-container"
          >
            <template x-for="(log, index) in logs" :key="index">
              <div
                class="py-1 border-b border-gray-800 hover:bg-gray-800/50 transition-colors"
              >
                <span
                  class="text-gray-500"
                  x-text="toETTime(log.timestamp)"
                ></span>
                <span
                  :class="{
                                'text-blue-400': log.level === 'INFO',
                                'text-yellow-400': log.level === 'WARNING',
                                'text-red-400': log.level === 'ERROR',
                                'text-gray-400': !['INFO', 'WARNING', 'ERROR'].includes(log.level)
                            }"
                  x-text="'[' + log.level + ']'"
                ></span>
                <span class="text-gray-300" x-text="log.message"></span>
              </div>
            </template>
            <div
              x-show="logs.length === 0"
              class="text-gray-500 text-center py-8"
            >
              No logs available
            </div>
          </div>
        </div>
      </main>

      <!-- Footer -->
      <footer class="border-t border-gray-700 bg-gray-950 mt-8">
        <div
          class="max-w-7xl mx-auto px-4 py-4 text-center text-sm text-gray-500"
        >
          Botija Crypto v3.4.0 | Last update:
          <span x-text="toETTime(new Date().toISOString())"></span>
        </div>
      </footer>
    </div>

    <script>
      function app() {
        return {
          loading: true,
          status: null,
          botStatus: { is_running: false, btc_balance: 0, usd_balance: 0 },
          trades: [],
          signals: [],
          cycles: [],
          cyclesCurrentPage: 1,
          cyclesItemsPerPage: 6,
          schedulerStatus: {
            running: false,
            seconds_until_next: 0,
            next_run_time: null,
            last_cycle: null,
            started_at: null,
            uptime_seconds: 0,
            last_cycle_result: {
              status: "pending",
              error: null,
              trigger: null,
            },
          },
          lastUpdate: "Never",
          manualCycleRunning: false,
          logs: [],
          logLevel: "",
          autoRefreshLogs: false,
          lastServerSync: Date.now(), // Track last sync to prevent drift
          // How It Works Modal
          showHowItWorks: false,
          howItWorksTab: 'strategy',

          // How It Works content
          getTabHTML(tab) {
            const tabs = {
              strategy: `<h3 class="text-lg font-semibold text-white">What Does Botija Crypto Do?</h3><p><strong class="text-green-400">Botija Crypto</strong> is an automated trading bot that buys and sells Bitcoin (BTC) for US Dollars (USD) on the Kraken exchange.</p><h4 class="text-md font-semibold text-white mt-4">How It Works:</h4><ul class="list-disc list-inside space-y-2 ml-2"><li>Analyzes the market <strong>every 4 hours</strong> (6 times per day)</li><li>Uses technical indicators to detect trends and momentum</li><li>Buys when the market shows strength (uptrend confirmed)</li><li>Sells when momentum fades or risk increases</li></ul><h4 class="text-md font-semibold text-white mt-4">Key Concepts:</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-2"><div class="bg-gray-800 rounded-lg p-3 border border-gray-700"><div class="font-semibold text-amber-400">EMA (20, 50, 200)</div><div class="text-sm text-gray-400">Moving averages that show trend direction. Price above EMAs = bullish, below = bearish.</div></div><div class="bg-gray-800 rounded-lg p-3 border border-gray-700"><div class="font-semibold text-purple-400">RSI (0-100)</div><div class="text-sm text-gray-400">Momentum indicator. Below 30 = oversold (buy opportunity), above 70 = overbought (sell signal).</div></div><div class="bg-gray-800 rounded-lg p-3 border border-gray-700"><div class="font-semibold text-blue-400">Winter Mode ‚ùÑÔ∏è</div><div class="text-sm text-gray-400">Safety feature that blocks trades during risky market conditions (BEAR or LATERAL regimes).</div></div><div class="bg-gray-800 rounded-lg p-3 border border-gray-700"><div class="font-semibold text-green-400">Swing Trading</div><div class="text-sm text-gray-400">Holds positions for days or weeks, capturing medium-term price movements rather than quick trades.</div></div></div>`,
              ai: `<h3 class="text-lg font-semibold text-white">The Brain Behind Decisions</h3><p>Every 4 hours, the bot sends market data to <strong class="text-blue-400">GPT-5.1</strong> (OpenAI's latest AI model) which analyzes:</p><ul class="list-disc list-inside space-y-1 ml-2"><li>Current price vs historical moving averages</li><li>Momentum strength and trend direction</li><li>Market volatility and risk levels</li><li>RSI for overbought/oversold conditions</li></ul><h4 class="text-md font-semibold text-white mt-4">Market Regimes:</h4><div class="space-y-2 mt-2"><div class="flex items-center gap-3 bg-emerald-900/20 rounded-lg p-3 border border-emerald-800/50"><span class="text-2xl">‚ñ≤</span><div><div class="font-semibold text-emerald-400">BULL</div><div class="text-sm text-gray-400">Uptrend detected ‚Üí Trading is <strong>allowed</strong>. Entry at EMA20+1.5%.</div></div></div><div class="flex items-center gap-3 bg-yellow-900/20 rounded-lg p-3 border border-yellow-800/50"><span class="text-2xl">‚óÜ</span><div><div class="font-semibold text-yellow-400">LATERAL</div><div class="text-sm text-gray-400">Sideways market ‚Üí Trading <strong>allowed</strong> (conservative). Entry at EMA50+1.5%.</div></div></div><div class="flex items-center gap-3 bg-orange-900/20 rounded-lg p-3 border border-orange-800/50"><span class="text-2xl">‚ö°</span><div><div class="font-semibold text-orange-400">VOLATILE</div><div class="text-sm text-gray-400">High volatility ‚Üí Trading is <strong>blocked</strong>. 0% win rate in backtest.</div></div></div><div class="flex items-center gap-3 bg-red-900/20 rounded-lg p-3 border border-red-800/50"><span class="text-2xl">‚ñº</span><div><div class="font-semibold text-red-400">BEAR</div><div class="text-sm text-gray-400">Downtrend detected ‚Üí Trading is <strong>blocked</strong>. Capital protection.</div></div></div></div><div class="bg-gray-800 rounded-lg p-4 border border-gray-700 mt-4"><div class="text-sm text-gray-400"><i class="fa-solid fa-lightbulb text-yellow-400 mr-1"></i><strong>Key Insight:</strong> Backtest shows the EMA50 exit logic is the true edge. AI provides consistency, but core alpha comes from technical rules.</div></div>`,
              backtest: `<h3 class="text-lg font-semibold text-white">üìä Proof It Works</h3><p>We tested our <strong class="text-green-400">Smart Trend Following</strong> strategy using <strong>7 years of real BTC price data</strong> (2018-2025) to see how it would have performed.</p>

<h4 class="text-md font-semibold text-white mt-4">üí∞ Final Results (2018-2025)</h4>
<div class="overflow-x-auto mt-2"><table class="w-full text-sm"><thead class="bg-gray-800"><tr><th class="px-4 py-2 text-left text-gray-400">Strategy</th><th class="px-4 py-2 text-right text-gray-400">Final Capital</th><th class="px-4 py-2 text-right text-gray-400">Return</th><th class="px-4 py-2 text-right text-gray-400">Max Drawdown</th></tr></thead><tbody class="divide-y divide-gray-700"><tr class="bg-green-900/20"><td class="px-4 py-2 font-medium text-green-400">ü§ñ Bot (SPOT)</td><td class="px-4 py-2 text-white text-right">$25,125</td><td class="px-4 py-2 text-green-400 text-right font-bold">+2,412.5%</td><td class="px-4 py-2 text-yellow-400 text-right">42.3%</td></tr><tr><td class="px-4 py-2 font-medium text-gray-400">üìà Buy & Hold BTC</td><td class="px-4 py-2 text-white text-right">$7,015</td><td class="px-4 py-2 text-gray-400 text-right">+601.5%</td><td class="px-4 py-2 text-red-400 text-right">76.6%</td></tr></tbody></table></div>

<div class="bg-emerald-900/20 rounded-lg p-3 border border-emerald-800/50 mt-3"><div class="text-sm text-emerald-300"><i class="fa-solid fa-trophy mr-1"></i><strong>Bottom line:</strong> $1,000 invested ‚Üí $25,125 (Bot) vs $7,015 (just holding BTC). Our strategy beats Buy & Hold by <strong>+1,811%</strong> with <strong>lower risk</strong>.</div></div>

<h4 class="text-md font-semibold text-white mt-4">üìà Yearly Performance</h4>
<div class="overflow-x-auto mt-2"><table class="w-full text-sm"><thead class="bg-gray-800"><tr><th class="px-3 py-2 text-left text-gray-400">Year</th><th class="px-3 py-2 text-right text-gray-400">Return</th><th class="px-3 py-2 text-right text-gray-400">Max DD</th><th class="px-3 py-2 text-center text-gray-400">Result</th></tr></thead><tbody class="divide-y divide-gray-700"><tr><td class="px-3 py-1 text-gray-300">2018</td><td class="px-3 py-1 text-red-400 text-right">-38.4%</td><td class="px-3 py-1 text-right">38.7%</td><td class="px-3 py-1 text-center">‚ùå</td></tr><tr><td class="px-3 py-1 text-gray-300">2019</td><td class="px-3 py-1 text-green-400 text-right">+120.6%</td><td class="px-3 py-1 text-right">50.0%</td><td class="px-3 py-1 text-center">‚úÖ</td></tr><tr><td class="px-3 py-1 text-gray-300">2020</td><td class="px-3 py-1 text-green-400 text-right">+334.1%</td><td class="px-3 py-1 text-right">21.5%</td><td class="px-3 py-1 text-center">‚úÖ</td></tr><tr><td class="px-3 py-1 text-gray-300">2021</td><td class="px-3 py-1 text-green-400 text-right">+79.7%</td><td class="px-3 py-1 text-right">42.3%</td><td class="px-3 py-1 text-center">‚úÖ</td></tr><tr><td class="px-3 py-1 text-gray-300">2022</td><td class="px-3 py-1 text-red-400 text-right">-23.5%</td><td class="px-3 py-1 text-right">31.4%</td><td class="px-3 py-1 text-center">‚ùå</td></tr><tr><td class="px-3 py-1 text-gray-300">2023</td><td class="px-3 py-1 text-green-400 text-right">+70.0%</td><td class="px-3 py-1 text-right">25.4%</td><td class="px-3 py-1 text-center">‚úÖ</td></tr><tr><td class="px-3 py-1 text-gray-300">2024</td><td class="px-3 py-1 text-green-400 text-right">+66.7%</td><td class="px-3 py-1 text-right">31.6%</td><td class="px-3 py-1 text-center">‚úÖ</td></tr><tr><td class="px-3 py-1 text-gray-300">2025</td><td class="px-3 py-1 text-green-400 text-right">+1.1%</td><td class="px-3 py-1 text-right">21.2%</td><td class="px-3 py-1 text-center">‚úÖ</td></tr></tbody></table></div>

<h4 class="text-md font-semibold text-white mt-4">üìä Key Statistics</h4>
<div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-2"><div class="bg-gray-800 rounded-lg p-3 border border-gray-700 text-center"><div class="text-2xl font-bold text-green-400">33</div><div class="text-xs text-gray-400">Total Trades</div></div><div class="bg-gray-800 rounded-lg p-3 border border-gray-700 text-center"><div class="text-2xl font-bold text-blue-400">39.4%</div><div class="text-xs text-gray-400">Win Rate</div></div><div class="bg-gray-800 rounded-lg p-3 border border-gray-700 text-center"><div class="text-2xl font-bold text-amber-400">$626</div><div class="text-xs text-gray-400">Total Fees Paid</div></div><div class="bg-gray-800 rounded-lg p-3 border border-gray-700 text-center"><div class="text-2xl font-bold text-purple-400">0.1%</div><div class="text-xs text-gray-400">Commission/Trade</div></div></div>

<h4 class="text-md font-semibold text-white mt-4">üîß For Technical Users</h4>
<div class="bg-gray-800/50 rounded-lg p-3 border border-gray-700 text-sm space-y-2"><div><strong class="text-blue-400">Strategy:</strong> Smart Trend Following with AI regime detection (EMA20, EMA50, EMA200, RSI14)</div><div><strong class="text-green-400">Entry:</strong> Price > EMA20 √ó 1.015 (BULL) or Price > EMA50 √ó 1.015 (LATERAL) | VOLATILE/BEAR blocked</div><div><strong class="text-red-400">Exit:</strong> Price < EMA50 √ó 0.985 (exception: BULL holds unless 3% below EMA50)</div><div><strong class="text-amber-400">Winter Protocol:</strong> Price < EMA200 ‚Üí Only BUY if AI=BULL AND RSI>65</div><div><strong class="text-purple-400">Costs:</strong> 0.1% commission + 0.1% slippage per trade</div></div>

<div class="bg-yellow-900/20 rounded-lg p-4 border border-yellow-800/50 mt-4"><div class="text-sm text-yellow-300"><i class="fa-solid fa-triangle-exclamation mr-1"></i><strong>Disclaimer:</strong> Past performance does not guarantee future results. Backtest uses historical data with realistic fees.</div></div>`,
              dashboard: `<h3 class="text-lg font-semibold text-white">Understanding Your Dashboard</h3><h4 class="text-md font-semibold text-white mt-4">Status Cards (Top Row)</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div class="bg-gray-800 rounded-lg p-3 border border-gray-700"><div class="font-semibold text-green-400">Bot Status</div><div class="text-sm text-gray-400">Shows ACTIVE (running) or INACTIVE. Also displays trading mode: PAPER (simulated) or REAL (live money).</div></div><div class="bg-gray-800 rounded-lg p-3 border border-gray-700"><div class="font-semibold text-amber-400">BTC Balance</div><div class="text-sm text-gray-400">Amount of Bitcoin you currently hold. Shows 0 when fully in USD.</div></div><div class="bg-gray-800 rounded-lg p-3 border border-gray-700"><div class="font-semibold text-emerald-400">USD Balance</div><div class="text-sm text-gray-400">Cash available to buy Bitcoin. This is your "dry powder".</div></div><div class="bg-gray-800 rounded-lg p-3 border border-gray-700"><div class="font-semibold text-purple-400">Total Value</div><div class="text-sm text-gray-400">Your complete portfolio value in USD (BTC value + USD balance).</div></div></div><h4 class="text-md font-semibold text-white mt-4">Controls</h4><div class="bg-gray-800 rounded-lg p-3 border border-gray-700"><ul class="text-sm space-y-1"><li><span class="text-blue-400 font-medium">Run:</span> Manually trigger a trading cycle</li><li><span class="text-blue-400 font-medium">Refresh:</span> Update the table with latest data</li><li><span class="text-blue-400 font-medium">Next cycle in:</span> Countdown to next analysis</li></ul></div>`,
              tech: `<h3 class="text-lg font-semibold text-white">Technology Stack</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"><div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><div class="flex items-center gap-2 mb-2"><i class="fa-brands fa-python text-yellow-400 text-xl"></i><span class="font-semibold text-white">Backend</span></div><ul class="text-sm text-gray-400 space-y-1"><li>‚Ä¢ FastAPI (Python) - REST API</li><li>‚Ä¢ SQLAlchemy + SQLite - Database</li><li>‚Ä¢ APScheduler - 4h automation</li></ul></div><div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><div class="flex items-center gap-2 mb-2"><i class="fa-brands fa-js text-yellow-300 text-xl"></i><span class="font-semibold text-white">Frontend</span></div><ul class="text-sm text-gray-400 space-y-1"><li>‚Ä¢ Alpine.js - Reactive UI</li><li>‚Ä¢ TailwindCSS - Styling</li><li>‚Ä¢ Font Awesome - Icons</li></ul></div><div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><div class="flex items-center gap-2 mb-2"><i class="fa-solid fa-coins text-blue-400 text-xl"></i><span class="font-semibold text-white">Trading</span></div><ul class="text-sm text-gray-400 space-y-1"><li>‚Ä¢ Kraken Exchange + CCXT</li><li>‚Ä¢ TA (indicators) + Pandas</li></ul></div><div class="bg-gray-800 rounded-lg p-4 border border-gray-700"><div class="flex items-center gap-2 mb-2"><i class="fa-solid fa-brain text-purple-400 text-xl"></i><span class="font-semibold text-white">AI & Hosting</span></div><ul class="text-sm text-gray-400 space-y-1"><li>‚Ä¢ OpenAI GPT-5.1</li><li>‚Ä¢ Ubuntu VPS + Nginx + SSL</li></ul></div></div>`
            };
            return tabs[tab] || '';
          },

          riskProfile: {
            profile: 'moderate',
            buy_score_threshold: 65,
            sell_score_threshold: 35,
            trade_amount_percent: 75,
            projected_monthly_return_min: 3,
            projected_monthly_return_max: 6
          },
          // Market regime from adaptive thresholds
          marketRegime: 'normal',
          currentVolatility: 0,
          adaptiveBuyThreshold: 65,
          adaptiveSellThreshold: 35,

          get timeSinceLastCycle() {
            if (!this.schedulerStatus.last_cycle) return "-";
            const lastTime = new Date(
              this.schedulerStatus.last_cycle
            ).getTime();
            const now = Date.now();
            const diff = Math.floor((now - lastTime) / 1000);
            const mins = Math.floor(diff / 60);
            const secs = diff % 60;
            return `${mins}m ${secs}s ago`;
          },

          formatTime(seconds) {
            const days = Math.floor(seconds / 86400);
            const hours = Math.floor((seconds % 86400) / 3600);
            const mins = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;

            const parts = [];
            if (days > 0) parts.push(`${days}d`);
            if (hours > 0) parts.push(`${hours}h`);
            if (mins > 0) parts.push(`${mins}m`);
            if (secs > 0 || parts.length === 0) parts.push(`${secs}s`);

            return parts.join(" ");
          },

          formatUptime(seconds) {
            if (!seconds || seconds <= 0) return "";
            const years = Math.floor(seconds / 31536000);
            const months = Math.floor((seconds % 31536000) / 2592000);
            const days = Math.floor((seconds % 2592000) / 86400);
            const hours = Math.floor((seconds % 86400) / 3600);
            const mins = Math.floor((seconds % 3600) / 60);

            if (years > 0) return `${years}y ${months}mo uptime`;
            if (months > 0) return `${months}mo ${days}d uptime`;
            if (days > 0) return `${days}d ${hours}h uptime`;
            if (hours > 0) return `${hours}h ${mins}m uptime`;
            return `${mins}m uptime`;
          },

          // Convert UTC timestamp to ET (New York timezone)
          toET(timestamp) {
            if (!timestamp) return "";
            return new Date(timestamp).toLocaleString("en-US", {
              timeZone: "America/New_York",
              year: "numeric",
              month: "2-digit",
              day: "2-digit",
              hour: "2-digit",
              minute: "2-digit",
              second: "2-digit",
              hour12: true,
            });
          },

          toETTime(timestamp) {
            if (!timestamp) return "";
            return new Date(timestamp).toLocaleTimeString("en-US", {
              timeZone: "America/New_York",
              hour: "2-digit",
              minute: "2-digit",
              second: "2-digit",
              hour12: true,
            });
          },

          // Compact date format MM/DD/YYYY
          toETDate(timestamp) {
            if (!timestamp) return "";
            return new Date(timestamp).toLocaleDateString("en-US", {
              timeZone: "America/New_York",
              month: "2-digit",
              day: "2-digit",
              year: "numeric",
            });
          },

          // Compact time format HH:MM PM
          toETTimeShort(timestamp) {
            if (!timestamp) return "";
            return new Date(timestamp).toLocaleTimeString("en-US", {
              timeZone: "America/New_York",
              hour: "2-digit",
              minute: "2-digit",
              hour12: true,
            });
          },

          // Format number with commas for thousands (e.g., 1,234.56)
          formatNumber(num, decimals = 2) {
            if (num == null || isNaN(num)) return "0.00";
            return parseFloat(num).toLocaleString("en-US", {
              minimumFractionDigits: decimals,
              maximumFractionDigits: decimals,
            });
          },

          // Format USD currency with $ and commas
          formatUSD(amount) {
            if (amount == null || isNaN(amount)) return "$0.00";
            return "$" + this.formatNumber(amount, 2);
          },

          // Format BTC with 8 decimals
          formatBTC(amount) {
            if (amount == null || isNaN(amount)) return "0.00000000";
            return this.formatNumber(amount, 8);
          },

          get totalPortfolio() {
            // Assuming BTC price needs to be fetched
            return this.botStatus.usd_balance;
          },

          // Pagination for cycles
          get paginatedCycles() {
            const start = (this.cyclesCurrentPage - 1) * this.cyclesItemsPerPage;
            const end = start + this.cyclesItemsPerPage;
            return this.cycles.slice(start, end);
          },

          get cyclesTotalPages() {
            return Math.ceil(this.cycles.length / this.cyclesItemsPerPage);
          },

          cyclesNextPage() {
            if (this.cyclesCurrentPage < this.cyclesTotalPages) {
              this.cyclesCurrentPage++;
            }
          },

          cyclesPrevPage() {
            if (this.cyclesCurrentPage > 1) {
              this.cyclesCurrentPage--;
            }
          },

          async init() {
            await this.refreshStatus();
            await this.fetchLogs();
            await this.fetchCycles();

            // Refresh everything every second
            setInterval(() => this.refreshStatus(), 1000);
          },

          async refreshStatus() {
            try {
              // Fetch scheduler status
              const resp = await fetch("/api/v1/bot/scheduler/status");
              if (resp.ok) this.schedulerStatus = await resp.json();

              // Fetch dashboard
              const dashResp = await fetch("/api/v1/bot/dashboard");
              if (dashResp.ok) {
                const d = await dashResp.json();
                this.botStatus = {
                  is_running: d.mode === "PAPER",
                  btc_balance: parseFloat(d.btc_balance) || 0,
                  usd_balance: parseFloat(d.usd_balance) || 0,
                };
              }

              this.loading = false;
            } catch (e) {
              console.error("refreshStatus error:", e);
              this.loading = false;
            }
          },

          async startBot() {
            try {
              await fetch("/api/v1/bot/start", { method: "POST" });
              this.refreshStatus();
            } catch (err) {
              console.error("Error starting bot:", err);
            }
          },

          async stopBot() {
            try {
              await fetch("/api/v1/bot/stop", { method: "POST" });
              this.refreshStatus();
            } catch (err) {
              console.error("Error stopping bot:", err);
            }
          },

          async runManualCycle() {
            if (this.manualCycleRunning) return;

            this.manualCycleRunning = true;
            try {
              const response = await fetch("/api/v1/bot/cycle", {
                method: "POST",
              });
              const result = await response.json();

              if (result.success) {
                console.log("‚úÖ Manual cycle completed:", result);
                // Refresh dashboard and cycles table after cycle
                await this.refreshStatus();
                await this.fetchCycles();
              } else {
                console.error("‚ùå Manual cycle failed:", result.message);
              }
            } catch (err) {
              console.error("Error running manual cycle:", err);
            } finally {
              this.manualCycleRunning = false;
            }
          },

          async fetchCycles() {
            try {
              const response = await fetch("/api/v1/bot/cycles?limit=100");
              if (response.ok) {
                const data = await response.json();
                this.cycles = data || [];
              }
            } catch (err) {
              console.error("Error fetching cycles:", err);
            }
          },

          async fetchRiskProfile() {
            try {
              const response = await fetch("/api/v1/bot/risk-profile");
              if (response.ok) {
                const data = await response.json();
                this.riskProfile = data;
              }
            } catch (err) {
              console.error("Error fetching risk profile:", err);
            }
          },

          async fetchMarketRegime() {
            try {
              const response = await fetch("/api/v1/indicators/current");
              if (response.ok) {
                const data = await response.json();
                this.marketRegime = data.market_regime || 'normal';
                this.currentVolatility = data.volatility || 0;
                this.adaptiveBuyThreshold = data.buy_threshold || 65;
                this.adaptiveSellThreshold = data.sell_threshold || 35;
              }
            } catch (err) {
              console.error("Error fetching market regime:", err);
            }
          },

          async setRiskProfile(profile) {
            try {
              const response = await fetch("/api/v1/bot/risk-profile", {
                method: "PUT",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ profile })
              });
              if (response.ok) {
                const data = await response.json();
                this.riskProfile = data;
                // Show success notification
                console.log(`Risk profile updated to ${profile}`);
              }
            } catch (err) {
              console.error("Error updating risk profile:", err);
            }
          },

          async fetchLogs() {
            try {
              const url = this.logLevel
                ? `/api/v1/bot/logs?limit=100&level=${this.logLevel}`
                : "/api/v1/bot/logs?limit=100";

              const response = await fetch(url);
              if (response.ok) {
                const data = await response.json();
                this.logs = data.logs || [];

                // Auto-scroll to bottom
                setTimeout(() => {
                  const container = document.getElementById("logs-container");
                  if (container) {
                    container.scrollTop = container.scrollHeight;
                  }
                }, 100);
              }
            } catch (err) {
              console.error("Error fetching logs:", err);
            }
          },
        };
      }
    </script>
  </body>
</html>
